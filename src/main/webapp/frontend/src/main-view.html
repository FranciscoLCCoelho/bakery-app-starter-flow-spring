<link rel="import" href="../bower_components/polymer/polymer-element.html">

<!--  Ensure that all components not used in templates but
      created from server-side are bundled -->
<link rel="import" href="components/confirm-dialog.html">
<link rel="import" href="views/errors/access-denied-view.html">
<link rel="import" href="views/login/login-view.html">
<link rel="import" href="views/storefront/storefront-view.html">
<link rel="import" href="views/storefront/order-card.html">
<link rel="import" href="views/dashboard/dashboard-view.html">
<link rel="import" href="views/admin/users/users-view.html">
<link rel="import" href="views/admin/products/products-view.html">

<!-- Imports used in this page -->
<link rel="import" href="components/app-container.html">
<link rel="import" href="components/app-navigation.html">

<dom-module id="main-view">
  <template>
    <style>
      app-container {
        background-color: var(--lumo-shade-5pct);
        color: var(--lumo-body-text-color);
        font-family: var(--lumo-font-family);
        overflow: auto;
        flex-direction: column-reverse;
      }

      app-container ::slotted(:not(app-navigation)) {
        flex: 1;
        align-items: center;
      }

      @media (min-width: 600px) {
        app-container {
          flex-direction: column;
        }
      }

      .offline[hidden] {
        display: none !important;
      }

      .offline {
        background-color: rgba(48, 64, 84, 0.11);
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        z-index: 10000;
      }

      .offline .content {
        width: 100%;
        height: 100%;
      }

      .offline .content .title {
        background-image: url("../../images/offline-login-banner.jpg");
        background-size: cover;
        background-position-x: center;
        display: table;
        width: 100%;
        padding: 32px;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
        box-sizing: border-box;
      }

      .offline .content .title h1 {
        font-weight: 300;
        color: #fff;
        margin-top: 2em;
        margin-bottom: 44px;
      }

      .offline .content .message {
        padding: 32px;
        background-color: #fff;
        color: rgba(48, 64, 84, 0.91);
        flex: 1;
        box-sizing: border-box;
        height: 100%;
      }

      .offline .content .message h2 {
        margin-top: 0;
        margin-bottom: 16px;
      }

      @media (min-width: 1000px) {
        .offline .content {
          max-width: 700px;
          margin: auto;
          height: auto;
          box-shadow: 0 2px 5px 0 rgba(48, 64, 84, 0.11);
        }

        .offline .content .title {
          border-top-left-radius: 4px;
          border-top-right-radius: 4px;
        }

        .offline .content .message {
          border-bottom-left-radius: 4px;
          border-bottom-right-radius: 4px;
          height: auto;
        }
      }
    </style>

    <app-container>
      <app-navigation id="appNavigation"></app-navigation>
      <slot></slot>
    </app-container>

    <div class="offline" hidden$="[[online]]">
      <div class="content">
        <div class="title">
            <h1>###Bakery###</h1>
        </div>
        <div class="message">
            <h2>You are offline</h2>
            <div>
                ###Bakery### requires an internet connection to work. You do not seem to have access to the server right
                now. Check your internet connection and try reloading the page to use the application.
            </div>
        </div>
      </div>
    </div>
  </template>

  <script>
    class MainView extends Polymer.Element {
      static get is() {
        return 'main-view';
      }

      ready() {
        super.ready();
        this.online = window.navigator.onLine;
        window.addEventListener('online',  () => this.online = true);
        window.addEventListener('offline',  () => this.online = false);
      }
    }

    window.customElements.define(MainView.is, MainView);
  </script>
</dom-module>
