<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/vaadin-charts/vaadin-chart.html">

<dom-module id="dashboard-yearly-sales">
  <template>
    <style>
      :host {
        flex: 1;
      }

      .wrapper {
        height: calc(30vh - 64px) !important;
        min-height: 200px;
      }
    </style>
    <div class="wrapper">
      <vaadin-chart id="areachart" title="[[title]]" class="yearly-sales">
      </vaadin-chart>
    </div>
  </template>

  <script>
    class DashboardYearlySales extends Polymer.Element {
      static get is() {
        return 'dashboard-yearly-sales';
      }

      static get properties() {
        return {
          series: {
            type: Object,
            observer: '_onSeriesChanged'
          },
          title: {
            type: Object,
            value: function() {
              return '';
            }
          }
        };
      }

      connectedCallback() {
        super.connectedCallback();
        this.$.areachart.update({
          chart: {
            borderRadius: 4,
            type: 'areaspline'
          },
          xAxis: {
            visible: false,
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
          },
          yAxis: {
            title: {
              enabled: false
            }
          }
        });
      }

      _onSeriesChanged(newSeries, oldSeries) {
        Polymer.RenderStatus.beforeNextRender(this, () => {
          var conf = this.$.areachart.configuration;
          if (newSeries && !oldSeries) {
            newSeries.forEach((element) => {
              conf.addSeries({
                name: element.title,
                data: element.series
              });
            });
          }
        });
      }
    }

    window.customElements.define(DashboardYearlySales.is, DashboardYearlySales);
  </script>
</dom-module>
