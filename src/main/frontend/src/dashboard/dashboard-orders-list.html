<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../storefront/storefront-item.html">

<dom-module id="dashboard-orders-list">

  <template>
    <style>
      :host {
        display: block;
      }

      .orders-list {
        height: 100%;
      }

      #wrapper {
        @apply --margin-style;
        @apply --fourth-row-style;
      }
	  </style>

    <div id="wrapper">
      <vaadin-grid class="orders-list" data-provider="[[dataProvider]]" size="[[ordersCount]]">
        <vaadin-grid-column>
          <template>
            <storefront-item item="[[item]]" day-column="true"></storefront-item>
          </template>
        </vaadin-grid-column>
      </vaadin-grid>
    </div>

  </template>

  <script>
      class DashboardOrdersList extends Polymer.Element {
        static get is() {
          return 'dashboard-orders-list';
        }

        ready() {
          super.ready();
          this.callbacks = {};
          this.dataProvider = function(params, callback) {
            this.dispatchEvent(new CustomEvent('page-request', {detail: {page: params.page, pageSize: params.pageSize}}));
            this.callbacks[params.page] = callback;
          }.bind(this);
        }

        loadPage(pageInfo) {
          if (pageInfo) {
            const pageInfoJSON = JSON.parse(pageInfo);
            this.callbacks[pageInfoJSON.pageNumber](pageInfoJSON.orders);
            this.callbacks[pageInfoJSON.pageNumber] = null;
          }
        }

      }

      window.customElements.define(DashboardOrdersList.is, DashboardOrdersList);
  </script>
</dom-module>
